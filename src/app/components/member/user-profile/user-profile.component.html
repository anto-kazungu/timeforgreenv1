<div class="profile-container">
  <div class="header">
    <button class="back-btn" (click)="goBack()">â† Back</button>
    <button class="logout-btn" (click)="logout()">Logout</button>
  </div>

  <div class="content">
    <div class="profile-header">
      <div class="profile-avatar-large">
        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Ccircle cx='60' cy='60' r='60' fill='%23FFD700'/%3E%3C/svg%3E" alt="Profile">
        <button class="change-photo-btn">ğŸ“·</button>
      </div>
      <h1>{{ user?.firstName }} {{ user?.lastName }}</h1>
      <p class="user-email">{{ user?.email }}</p>
      
      <div class="level-badge" [style.background]="levelColor">
        <span class="level-icon">{{ levelIcon }}</span>
        <div class="level-info">
          <span class="level-title">Level {{ userLevel }} - {{ levelName }}</span>
          <div class="level-progress-container">
            <div class="level-progress-bar" [style.width.%]="levelProgress"></div>
          </div>
          <span class="level-progress-text">{{ levelProgress }}% to {{ nextLevelName }} ({{ xpToNextLevel }} XP needed)</span>
        </div>
      </div>

      <div class="stats-row">
        <div class="stat-card">
          <span class="stat-value">{{ greenPoints }}</span>
          <span class="stat-label">Green Points</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">Level {{ userLevel }}</span>
          <span class="stat-label">{{ levelName }}</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">{{ communitiesCount }}</span>
          <span class="stat-label">Communities</span>
        </div>
      </div>

      <div class="stats-row secondary">
        <div class="stat-card">
          <span class="stat-icon">ğŸ“</span>
          <span class="stat-value">{{ trainingsCompleted }}</span>
          <span class="stat-label">Trainings Completed</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">ğŸ“…</span>
          <span class="stat-value">{{ eventsAttended }}</span>
          <span class="stat-label">Events Attended</span>
        </div>
      </div>
    </div>

    <div class="profile-form">
      <h2>Personal Information</h2>
      
      <form (ngSubmit)="updateProfile()">
        <div class="form-row">
          <div class="form-group">
            <label>First Name</label>
            <input 
              type="text" 
              [(ngModel)]="firstName" 
              name="firstName"
              placeholder="Enter first name"
              required
            />
          </div>
          
          <div class="form-group">
            <label>Last Name</label>
            <input 
              type="text" 
              [(ngModel)]="lastName" 
              name="lastName"
              placeholder="Enter last name"
              required
            />
          </div>
        </div>

        <div class="form-group">
          <label>Username</label>
          <input 
            type="text" 
            [(ngModel)]="username" 
            name="username"
            placeholder="Enter username"
            required
          />
        </div>

        <div class="form-group">
          <label>Email</label>
          <input 
            type="email" 
            [(ngModel)]="email" 
            name="email"
            placeholder="Enter email"
            required
          />
        </div>

        <div class="form-group">
          <label>Bio</label>
          <textarea 
            [(ngModel)]="bio" 
            name="bio"
            placeholder="Tell us about yourself and your environmental goals..."
            rows="4"
          ></textarea>
        </div>

        @if (updateMessage) {
          <div class="message" [class.success]="updateSuccess" [class.error]="!updateSuccess">
            {{ updateMessage }}
          </div>
        }

        <div class="form-actions">
          <button type="button" class="cancel-btn" (click)="resetForm()">Reset</button>
          <button type="submit" class="save-btn">Save Changes</button>
        </div>
      </form>
    </div>

    <div class="achievements-section">
      <h2>ğŸ† Achievements</h2>
      <div class="achievements-grid">
        <div class="achievement-card" *ngFor="let achievement of achievements">
          <div class="achievement-icon">{{ achievement.icon }}</div>
          <div class="achievement-info">
            <h3>{{ achievement.title }}</h3>
            <p>{{ achievement.description }}</p>
          </div>
          <div class="achievement-badge" [class.unlocked]="achievement.unlocked">
            {{ achievement.unlocked ? 'âœ“' : 'ğŸ”’' }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
